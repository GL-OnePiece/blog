<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <canvas id="mycanv" width="500" height="500"></canvas>

    <script>
      var canv = document.getElementById("mycanv");
      var ctx = canv.getContext("2d");
      //变形：移动translate 旋转rotate 缩放scale
      //移动画布，重置原点（0，0）
      ctx.translate(250, 250);
      //绘制表盘
      function setClock() {
        ctx.clearRect(-250, -250, 500, 500);
        drawRRect(-200, -200, 400, 400, 70);
        ctx.save();
        ctx.beginPath();
        ctx.arc(0, 0, 180, 0, 2 * Math.PI);
        ctx.fillStyle = "#eee";
        ctx.fill();
        ctx.restore();
        //绘制刻度（数字）
        ctx.save();
        for (let i = 1; i <= 12; i++) {
          ctx.rotate((30 * Math.PI) / 180);
          ctx.font = "bold 20px Arial";
          ctx.textAlign = "center";
          ctx.fillText(i, 0, -160);
        }
        //获取系统时间

        var cdate = new Date();
        var hh = cdate.getHours(),
          mm = cdate.getMinutes(),
          ss = cdate.getSeconds();
        //绘制指针：时分秒
        drawline(hh * 30 + mm / 2, 6, 0, -130, "#f00");
        drawline(mm * 6, 3, 0, -150);
        drawline(ss * 6, 2, 30, -170, "#0f0");
        ctx.save();
        ctx.beginPath();
        ctx.fillStyle = "#f31";
        ctx.arc(0, 0, 5, 0, 2 * Math.PI);
        ctx.fill();
        ctx.restore();
      }

      //绘制表盘
      function drawRRect(x, y, w, h, r) {
        ctx.save();
        ctx.beginPath();
        ctx.moveTo(x, y + r);
        ctx.arcTo(x, y + h, x + w, y + h, r);
        ctx.arcTo(x + w, y + h, x + w, y, r);
        ctx.arcTo(x + w, y, x, y, r);
        ctx.arcTo(x, y, x, y + h, r);
        ctx.stroke();
        ctx.fillstyle = "#111";
        ctx.fill();
        ctx.restore();
      }

      function drawline(deg, lw, lh_0, lh_1, c) {
        ctx.save();
        ctx.rotate((deg * Math.PI) / 180);
        ctx.lineWidth = lw;
        ctx.strokeStyle = c;
        ctx.lineCap = "round";
        ctx.beginPath();
        ctx.moveTo(0, lh_0);
        ctx.lineTo(0, lh_1);
        ctx.stroke();
        ctx.restore();
      }
      setClock();
      setInterval(setClock, 1000);
    </script>
  </body>
</html>
